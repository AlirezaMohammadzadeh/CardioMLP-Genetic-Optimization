# مقدمه
بیماری‌های قلبی عروقی (Cardiovascular Diseases - CVD) به یکی از مهم‌ترین بیماری‌ها در سراسر جهان تبدیل شده‌اند و بالاترین نرخ مرگ و میر و ناتوانی را به خود اختصاص داده‌اند، بدون توجه به اینکه کشورها توسعه‌یافته هستند یا خیر. بر اساس گزارش سازمان بهداشت جهانی، CVD سالانه باعث مرگ حدود 17.9 میلیون نفر می‌شود. به دلیل روند سریع و وخیم شدن این بیماری، بررسی عوامل خطر آن پیچیده شده است. مطالعات بسیاری به صورت آزمایشگاهی (in vitro)، درون‌بدنی (in vivo) و شبیه‌سازی (in silico) بر روی عوامل خطر CVD انجام شده است. این مطالعات نشان داده‌اند که فشار خون سیستولیک و دیاستولیک با عواملی مانند سیگار کشیدن، پیری، زیرگروه‌های وزنی، کلسترول، سطح گلوکز و مصرف الکل مرتبط هستند. به دلیل فرآیند پیچیده و گسترده عوامل خطر، تشخیص زودهنگام CVD و مرحله درمان آن به یک ضرورت تبدیل شده است.

در مطالعات اخیر، تکنیک‌های یادگیری ماشین (Machine Learning - ML) که می‌توانند تعاملات پیچیده عوامل مرتبط با بیماری را توضیح دهند، به طور فزاینده‌ای در مدل‌های پیش‌بینی استفاده می‌شوند. مطالعات بسیاری با استفاده از روش‌های ML و یادگیری عمیق (Deep Learning - DL) انجام شده است. به عنوان مثال، Al'Aref و همکاران در سال 2018 با استفاده از روش‌های تصویربرداری غیرتهاجمی به مطالعات CVD کمک کردند، Ghosh و همکاران در سال 2021 از مدل‌های ML استفاده کردند، و Aryal و همکاران در سال 2020 از روش‌های مبتنی بر میکروبیوم روده استفاده کردند.

روش‌های هوش مصنوعی قابل توضیح (Explainable Artificial Intelligence - XAI) به عنوان راه‌حلی برای نگرانی‌ها درباره قابلیت توضیح مدل و الگوریتم‌های هوش مصنوعی ظهور کرده‌اند. هوش مصنوعی قابل توضیح اخیراً برای کمک به متخصصان بهداشت و درمان در درک روابط بین مدل‌های ML و نتایج پیش‌بینی‌شده آن‌ها استفاده شده است. در عین حال، XAI می‌تواند توانایی تفسیر الگوریتم‌ها را بهبود بخشد و دقت پیش‌بینی مدل‌های پیچیده ML را حفظ کند. در میان مطالعات مربوط به عوامل خطر CVD، مطالعات XAI کمیاب هستند. در این مطالعه، انتخاب اهمیت ویژگی و روش‌های XAI بر روی دیتاست حاوی عوامل خطر CVD استفاده شد. ما اهمیت غالب عوامل خطر بر CVD را با روش استاندارد اهمیت، روش اهمیت ویژگی جایگزین (Permutation Feature Importance - PFI) و روش XAI مقایسه کردیم. با استفاده از روش توضیحات افزایشی شاپلی (Shapley Additive Explanations - SHAP)، عوامل خطری که به طور قابل توجهی بر CVD تأثیر می‌گذارند را شناسایی کردیم. ما روابط بین CVD و عوامل خطر را با نمودارهای مختلف XAI آشکار کردیم و دقت مدل قابل توضیح خود را با مقایسه آن با داده‌های ادبیات اثبات کردیم.

هدف این تحقیق بررسی و مقایسه الگوریتم‌های مختلف یادگیری ماشین و یادگیری عمیق برای پیش‌بینی CVD است.

# درباره دیتاست
این دیتاست که شامل اطلاعات دقیقی درباره عوامل خطر CVD است، با جستجوی "Exploring Risk Factors for Cardiovascular Disease in Adults" در سایت Kaggle به دست آمده است. همچنین، این دیتاست در آدرس https://data.world/kudem در دسترس است. دیتاست شامل اطلاعاتی درباره سن، جنسیت، قد، وزن، مقادیر فشار خون، سطح کلسترول و گلوکز، عادات سیگار کشیدن، فعالیت بدنی و مصرف الکل است که به طور مکرر در میان عوامل خطر CVD برای 70000 فرد قرار دارند. علاوه بر این، اطلاعاتی درباره وجود یا عدم وجود CVD وجود دارد که عامل اصلی در دستیابی به هدف مطالعه و نتایج مورد انتظار است. این دیتاست به عنوان منبعی عالی برای محققان در جهت ادغام تکنیک‌های مختلف ML، DL و AI برای کشف روابط بالقوه بین عوامل خطر CVD و CVD دیده می‌شود که در نهایت می‌تواند به درک بهتر عوامل خطر CVD و طراحی اقدامات پیشگیرانه بهتر منجر شود. به همین دلیل، این دیتاست به عنوان یک قطب‌نما برای تعیین گزینه‌های درمانی مناسب به دلیل تشخیص زودهنگام CVD استفاده شده است.

# انتخاب ویژگی (Feature Selection)
روش اهمیت ویژگی جایگزین (Permutation Feature Importance) توضیح می‌دهد که کدام ویژگی‌ها عملکرد و امتیاز مدل را با اندازه‌گیری کاهش عملکرد مدل پس از مخلوط کردن مقادیر یک ویژگی منفرد گمراه می‌کنند. این روش مستقل به ما می‌گوید که مدل چقدر به هر ویژگی وابسته است نسبت به کاهش امتیاز مدل. در این مطالعه، تابع `permutation_importance` برای نشان دادن اهمیت هر ویژگی در دیتاست که بر CVD تأثیر می‌گذارد، استفاده شده است.

روش توضیحات افزایشی شاپلی (Shapley Additive Explanations) ابتدا در نظریه بازی برای تعیین سهم بازیکنان در بازی استفاده شد. این الگوریتم راهی عالی برای ایجاد هم‌افزایی با مهندسی یک مدل جعبه سیاه است. هنگامی که با الگوریتم‌های ML لوندبرگ و لی ترکیب می‌شود، این چارچوب که با مقادیر شاپلی کار می‌کند، شفافیت، قابلیت توضیح و پیش‌بینی‌پذیری را به مدل‌های جعبه سیاه آورد. SHAP بر روی تمام ترکیبات ممکن از ویژگی‌ها کار می‌کند و میانگین سهم‌ها را محاسبه می‌کند. این مطالعه طراحی توضیحی با الگوریتم‌های SHAP برای عوامل خطر CVD ارائه می‌دهد. اگرچه مطالعات زیادی در مورد اهمیت عوامل خطر CVD انجام شده است، این مطالعات ممکن است برای رسیدن به تعاملات بین عوامل برای خروجی‌های مدل کافی نباشند. به همین دلیل، ادغام XAI با استفاده از دیتاست حاوی بسیاری از عوامل خطر انجام شد. ما نمودارهای نیروی فردی و جمعی را برای درک چگونگی تأثیر متغیرهای عوامل خطر بر نتایج مدل بررسی کردیم. سپس، یافته‌های TreeSHAP را با مطالعات قبلی که عامل علّی CVD و تأثیر عوامل خطر بر CVD را پیشنهاد می‌کنند، مقایسه کردیم.

# الگوریتم‌های کلاسیک ماشین لرنینگ
## درخت تصمیم (Decision Tree)
درخت تصمیم یکی از الگوریتم‌های ساده و قابل فهم در یادگیری ماشین است که برای طبقه‌بندی و رگرسیون استفاده می‌شود. این الگوریتم با تقسیم داده‌ها به زیرمجموعه‌های کوچکتر، تصمیم‌گیری می‌کند.

## جنگل تصادفی (RandomForest)
جنگل تصادفی یک الگوریتم یادگیری گروهی است که با ترکیب چندین درخت تصمیم، دقت پیش‌بینی را افزایش می‌دهد. این الگوریتم به دلیل مقاومت در برابر بیش‌برازش (Overfitting) بسیار محبوب است.

## XGBoost
XGBoost یک الگوریتم تقویتی (Boosting) است که با بهبود تدریجی مدل‌ها، دقت پیش‌بینی را افزایش می‌دهد. این الگوریتم به دلیل سرعت و کارایی بالا در بسیاری از مسابقات داده‌کاوی استفاده می‌شود.

## KNeighbor Classifier
این الگوریتم بر اساس نزدیکی داده‌ها به یکدیگر عمل می‌کند و برای طبقه‌بندی داده‌ها از نزدیک‌ترین همسایگان استفاده می‌کند.

## SVM Classifier
ماشین بردار پشتیبان (Support Vector Machine - SVM) یکی از الگوریتم‌های قدرتمند در یادگیری ماشین است که برای طبقه‌بندی داده‌ها استفاده می‌شود. این الگوریتم با یافتن یک ابرصفحه بهینه، داده‌ها را به دو دسته تقسیم می‌کند.

## Gaussian NB
ناوی بیز گوسی (Gaussian Naive Bayes) یک الگوریتم ساده و سریع برای طبقه‌بندی داده‌ها است که بر اساس قضیه بیز عمل می‌کند.

## Logistic Regression
رگرسیون لجستیک یک روش آماری برای مدل‌سازی رابطه بین متغیر وابسته دودویی و یک یا چند متغیر مستقل است.

# الگوریتم‌های یادگیری عمیق
## MLP (Perceptron چند لایه)
MLP یک نوع شبکه عصبی مصنوعی است که از چندین لایه پرسپترون برای یادگیری الگوهای پیچیده استفاده می‌کند.

## KAN (شبکه عصبی کانولوشنی)
شبکه عصبی کانولوشنی (Convolutional Neural Network - CNN) برای پردازش داده‌های تصویری و شناسایی الگوهای پیچیده استفاده می‌شود.

## Genetic MLP
Genetic MLP ترکیبی از الگوریتم‌های ژنتیک و شبکه‌های عصبی است که برای بهینه‌سازی ساختار و وزن‌های شبکه استفاده می‌شود.

# جمع‌بندی
در این تحقیق، الگوریتم‌های مختلف یادگیری ماشین و یادگیری عمیق برای پیش‌بینی بیماری‌های قلبی عروقی مورد بررسی قرار گرفتند. نتایج نشان داد که الگوریتم‌های یادگیری عمیق به دلیل توانایی در یادگیری الگوهای پیچیده، دقت بالاتری دارند.

# منابع
- مقاله CVD_paper
- منابع دیگر مرتبط با موضوع 